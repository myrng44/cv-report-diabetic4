<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/ANALYSIS_CONFUSION_MATRIX.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ANALYSIS_CONFUSION_MATRIX.py" />
              <option name="updatedContent" value="&quot;&quot;&quot;&#10;PHÂN TÍCH CONFUSION MATRIX - PHASE 1 CLASSIFICATION&#10;================================================================================&#10;&#10;Confusion Matrix:&#10;         Pred 0  Pred 1  Pred 2  Pred 3  Pred 4&#10;True 0   [32      0       2       0       0]     → 34 samples&#10;True 1   [3       0       2       0       0]     → 5 samples&#10;True 2   [4       2       23      2       1]     → 32 samples  &#10;True 3   [2       0       10      7       0]     → 19 samples&#10;True 4   [1       0       6       2       4]     → 13 samples&#10;         ─────────────────────────────────&#10;Total:   42      2       43      11      5      = 103 samples&#10;&#10;Class distribution:&#10;- Class 0 (No DR):          34 samples (33.0%)  ✅ GOOD&#10;- Class 1 (Mild):           5 samples  (4.9%)   ⚠️  SEVERE IMBALANCE&#10;- Class 2 (Moderate):       32 samples (31.1%)  ✅ GOOD&#10;- Class 3 (Severe):         19 samples (18.4%)  ⚠️  IMBALANCE&#10;- Class 4 (Proliferative):  13 samples (12.6%)  ⚠️  IMBALANCE&#10;&#10;================================================================================&#10;VẤN ĐỀ PHÁT HIỆN:&#10;================================================================================&#10;&#10; CRITICAL ISSUES:&#10;&#10;1. CLASS 1 BỊ BỎ QUÁ (0% recall!)&#10;   - Model dự đoán 0/5 đúng Class 1&#10;   - Tất cả 5 samples bị misclassified:&#10;     * 3 → Class 0 (nhầm là No DR)&#10;     * 2 → Class 2 (nhầm là Moderate)&#10;   - Class 1 GẦN NHƯ KHÔNG TỒN TẠI trong predictions!&#10;&#10;2. CLASS IMBALANCE TRẦm TRỌNG:&#10;   - Class 1: 5 samples (4.9%)  ← QUÁ ÍT!&#10;   - Class 0: 34 samples (33.0%)&#10;   - Model bias về Class 0 và Class 2&#10;&#10;3. CONFUSION giữa các classes lân cận:&#10;   - Class 3 → Class 2: 10/19 samples (53% bị nhầm)&#10;   - Class 4 → Class 2: 6/13 samples (46% bị nhầm)&#10;   - Model có xu hướng dự đoán Class 2 quá mức&#10;&#10;================================================================================&#10;METRICS TÍNH TOÁN:&#10;================================================================================&#10;&#10;Per-Class Performance:&#10;&#10;Class 0 (No DR):&#10;  - Precision: 32/42 = 76.2%  ✅&#10;  - Recall: 32/34 = 94.1%     ✅ EXCELLENT&#10;  - F1: 84.2%&#10;&#10;Class 1 (Mild): ⚠️  DISASTER&#10;  - Precision: 0/2 = 0%       ❌ TERRIBLE&#10;  - Recall: 0/5 = 0%          ❌ TERRIBLE&#10;  - F1: 0%                    ❌ COMPLETE FAILURE&#10;&#10;Class 2 (Moderate):&#10;  - Precision: 23/43 = 53.5%  ⚠️  LOW&#10;  - Recall: 23/32 = 71.9%     ⚠️  OK&#10;  - F1: 61.3%&#10;&#10;Class 3 (Severe):&#10;  - Precision: 7/11 = 63.6%   ⚠️  LOW&#10;  - Recall: 7/19 = 36.8%      ❌ POOR&#10;  - F1: 46.7%&#10;&#10;Class 4 (Proliferative):&#10;  - Precision: 4/5 = 80%      ✅&#10;  - Recall: 4/13 = 30.8%      ❌ POOR&#10;  - F1: 44.4%&#10;&#10;Overall Accuracy: (32+0+23+7+4)/103 = 66/103 = 64.1%&#10;&#10;Macro F1: (84.2 + 0 + 61.3 + 46.7 + 44.4) / 5 = 47.3%  ⚠️  LOW&#10;&#10;================================================================================&#10;KẾT LUẬN:&#10;================================================================================&#10;&#10;1. ✅ Model học tốt Class 0 (No DR)&#10;2. ❌ Model HOÀN TOÀN THẤT BẠI với Class 1 (Mild)&#10;3. ⚠️  Model có bias mạnh về Class 2 (over-predict)&#10;4. ⚠️  Performance kém với Class 3, 4 (under-represented)&#10;5. ⚠️  Severe class imbalance là nguyên nhân chính&#10;&#10;PRIORITY: Cải thiện Class 1, 3, 4 performance!&#10;&#10;================================================================================&#10;&quot;&quot;&quot;&#10;&#10;# Calculate and print detailed metrics&#10;import numpy as np&#10;&#10;cm = np.array([&#10;    [32, 0, 2, 0, 0],&#10;    [3, 0, 2, 0, 0],&#10;    [4, 2, 23, 2, 1],&#10;    [2, 0, 10, 7, 0],&#10;    [1, 0, 6, 2, 4]&#10;])&#10;&#10;print(&quot;=&quot;*80)&#10;print(&quot; DETAILED ANALYSIS&quot;)&#10;print(&quot;=&quot;*80)&#10;&#10;classes = ['Class 0 (No DR)', 'Class 1 (Mild)', 'Class 2 (Moderate)', &#10;           'Class 3 (Severe)', 'Class 4 (Proliferative)']&#10;&#10;for i in range(5):&#10;    true_count = cm[i].sum()&#10;    pred_count = cm[:, i].sum()&#10;    correct = cm[i, i]&#10;    &#10;    precision = correct / pred_count if pred_count &gt; 0 else 0&#10;    recall = correct / true_count if true_count &gt; 0 else 0&#10;    f1 = 2 * precision * recall / (precision + recall) if (precision + recall) &gt; 0 else 0&#10;    &#10;    print(f&quot;\n{classes[i]}:&quot;)&#10;    print(f&quot;  Samples: {true_count} ({true_count/103*100:.1f}%)&quot;)&#10;    print(f&quot;  Precision: {precision:.3f} ({precision*100:.1f}%)&quot;)&#10;    print(f&quot;  Recall: {recall:.3f} ({recall*100:.1f}%)&quot;)&#10;    print(f&quot;  F1-Score: {f1:.3f} ({f1*100:.1f}%)&quot;)&#10;    &#10;    if recall &lt; 0.5:&#10;        print(f&quot;  ⚠️  LOW RECALL - Model misses {(1-recall)*100:.0f}% of this class!&quot;)&#10;    if precision &lt; 0.6:&#10;        print(f&quot;  ⚠️  LOW PRECISION - Many false positives!&quot;)&#10;&#10;overall_acc = cm.diagonal().sum() / cm.sum()&#10;print(f&quot;\n{'='*80}&quot;)&#10;print(f&quot;Overall Accuracy: {overall_acc:.3f} ({overall_acc*100:.1f}%)&quot;)&#10;print(&quot;=&quot;*80)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>